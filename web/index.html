<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Fear</title>

	<link rel="stylesheet" href="css/csvtable.css" type="text/css" />

	<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
	<script type="text/javascript" src="js/jquery.csvToTable.js"></script>
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script type="text/javascript" src="js/jquery.csv-0.71.js "></script>

	<script>
	google.load("visualization", "1", {packages:["corechart"]});
	google.setOnLoadCallback(drawChart);

	// this has to be a global function
	function drawChart() {
	   // grab the CSV
	   $.get("ping.csv", function(csvString) {
	      // transform the CSV string into a 2-dimensional array
	      var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});

	      // this new DataTable object holds all the data
	      var data = new google.visualization.arrayToDataTable(arrayData);

	      // this view can select a subset of the data at a time
	      var view = new google.visualization.DataView(data);
	      view.setColumns([0,1]);

	     // set chart options
	     var options = {
	        title: "Ping!",
	        hAxis: {title: data.getColumnLabel(1), minValue: 0, maxValue: data.getColumnRange(1).max},
	        vAxis: {title: data.getColumnLabel(0)},
	        legend: 'none'
	     };

	     // create the chart object and draw it
	     var chart = new google.visualization.BarChart(document.getElementById('chart'));
	     chart.draw(view, options);
	  });
	}
	</script>
	
	<script>
	$(function() {
		$('#CSVTableDead').CSVToTable('dead.csv', { loadingImage: 'images/kitten-100-100.jpg', startLine: 0 });
		$('#CSVTablePing').CSVToTable('ping.csv', { loadingImage: 'images/kitten-100-100.jpg', startLine: 0 });
	});
	</script>
</head>
<body>

<h2>The following machines are not responding to hails</h2>
<br>
<div id="CSVTableDead"></div>
<br>

<h2>Average pings to alive machines</h2>
<br>
<div id="CSVTablePing"></div>
<br>

<h2>A chart with those pings</h2>
<div id="chart" style="width: 900px; height: 500px;"></div>

</body>
</html>